<div class="contenedor-principal">
  <!-- Encabezado -->
  <header class="encabezado">
    <div class="logo">
      <h1>MRbouquets</h1>
    </div>
    <nav class="navegacion">
      <ul class="lista-navegacion">
        <li><a routerLink="/">Inicio</a></li>
        <li><a routerLink="/catalogo">Cat√°logo</a></li>
        <li><a routerLink="/contacto">Contacto</a></li>
      </ul>
    </nav>

    <!-- Acciones de usuario -->
    <!-- Acciones de usuario -->
<div class="acciones-usuario">
    <!-- Si est√° logueado -->
    <ng-container *ngIf="auth.isLoggedIn(); else anon">
      <span class="saludo">Hola, {{ userName }}</span>
      <!-- Enlace al carrito s√≥lo para usuarios logueados -->
      <a routerLink="/perfil" class="boton">üë§ Mi Perfil</a>
      <a routerLink="/carrito" class="boton">
        üõí Mi carrito
      </a>
      <button class="boton cerrar-sesion" (click)="logout()">
        Cerrar sesi√≥n
      </button>
    </ng-container>
    <!-- Si no est√° logueado -->
    <ng-template #anon>
      <a routerLink="/login">Iniciar sesi√≥n</a>
      <a routerLink="/registro" class="boton boton-principal">Registro</a>
    </ng-template>
  </div>
  </header>

  <!-- Secci√≥n banner -->
  <section class="seccion-banner">
    <img src="http://localhost/MRBouquets/frontend/public/img/bienvenida.png" alt="Banner Principal" class="banner-img">
  </section>

  <!-- Secci√≥n de destacados -->
  <section class="seccion-destacados">
    <h2 class="titulo-seccion">Bouquets Destacados</h2>
    <!-- Estado de carga -->
    <div *ngIf="loading" class="text-center my-4">
      <p>Cargando productos...</p>
    </div>

    <!-- Mensaje de error -->
    <div *ngIf="error" class="alert alert-danger" role="alert">
      {{ error }}
    </div>

    <!-- Productos Regulares -->
    <div *ngIf="!loading && !error" class="grid-destacados">
      <article class="tarjeta-bouquet" *ngFor="let producto of productosRegulares">
        <img [src]="'http://localhost/MRBouquets/frontend/public/img/' + producto.img" 
             [alt]="producto.nombre">
        <h3>{{ producto.nombre }}</h3>
        <p>{{ producto.descripcion }}</p>
        <span class="precio">{{ producto.precio | currency:'EUR':'symbol':'1.2-2' }}</span>
        <div class="botones-tarjeta">
          <button class="boton-ver" (click)="verDetalles(producto)">
            Ver detalles
          </button>
          <button class="boton" (click)="onAddToCart(producto)">
            Agregar al carrito
          </button>
        </div>
      </article>
    </div>
  </section>

  <!-- Secci√≥n de Ocasiones Especiales -->
  <section class="seccion-ocasiones">
    <h2 class="titulo-seccion">Ocasiones Especiales</h2>
    <div class="carrusel-ocasiones" #carrusel>
      <div class="carrusel-contenedor" [style.transform]="'translateX(' + slideOffset + '%)'">
        <div class="tarjeta-ocasion" *ngFor="let ocasion of productosOcasiones">
          <div class="ocasion-imagen">
            <img [src]="'http://localhost/MRBouquets/frontend/public/img/' + ocasion.img" 
                 [alt]="ocasion.nombre">
            <div class="ocasion-overlay">
              <i [class]="getIconForOcasion(ocasion)"></i>
            </div>
          </div>
          <div class="ocasion-contenido">
            <h3>{{ ocasion.nombre }}</h3>
            <p class="precio">{{ ocasion.precio | currency:'EUR':'symbol':'1.2-2' }}</p>
            <div class="botones-tarjeta">
              <button class="boton-ver" (click)="verDetalles(ocasion)">
                Ver detalles
              </button>
              <button class="boton-ocasion" (click)="onAddToCart(ocasion)">
                Agregar al carrito
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Controles del carrusel -->
      <div class="carrusel-controles">
        <button class="control-btn prev" (click)="prevSlide()">
          <i class="fas fa-chevron-left"></i>
        </button>
        <div class="indicadores">
          <span *ngFor="let ocasion of productosOcasiones; let i = index" 
                [class.activo]="currentSlide === i"
                (click)="goToSlide(i)">
          </span>
        </div>
        <button class="control-btn next" (click)="nextSlide()">
          <i class="fas fa-chevron-right"></i>
        </button>
      </div>
    </div>
  </section>

  <!-- Secci√≥n de novedades -->
  <section class="seccion-novedades">
    <h2 class="titulo-seccion">Novedades</h2>
    <div class="grid-novedades">
      <div class="bloque-novedad">
        <i class="fas fa-flower-daffodil icono-novedad"></i>
        <h4>Lanzamiento Primavera</h4>
        <p>Explora nuestra nueva colecci√≥n de ramos de temporada con un 15% de descuento. Flores frescas y dise√±os exclusivos para celebrar la primavera.</p>
      </div>
      <div class="bloque-novedad">
        <i class="fas fa-gift icono-novedad"></i>
        <h4>Bouquets para cada ocasi√≥n</h4>
        <p>Descubre nuestra amplia selecci√≥n de ramos personalizados para cada momento especial. Desde cumplea√±os hasta bodas, tenemos el bouquet perfecto.</p>
      </div>
      <div class="bloque-novedad">
        <i class="fas fa-truck icono-novedad"></i>
        <h4>Env√≠o Gratis</h4>
        <p>En todos los pedidos superiores a 60‚Ç¨ dentro de Madrid. Entrega el mismo d√≠a para pedidos realizados antes de las 14:00h.</p>
      </div>
    </div>
  </section>

  <!-- Pie de p√°gina -->
  <footer class="pie-pagina">
    <p>¬© 2025 MRbouquets. Todos los derechos reservados.</p>
    <ul class="lista-redes">
      <li><a href="https://www.facebook.com/">Facebook</a></li>
      <li><a href="https://www.instagram.com/">Instagram</a></li>
      <li><a href="https://www.tiktok.com/">TikTok</a></li>
    </ul>
  </footer>
</div>

<!-- Modal de invitaci√≥n a login -->
<div class="modal-backdrop" *ngIf="showLoginModal">
  <div class="modal-contenido">
    <h3>¬°Ups!</h3>
    <p>Para a√±adir productos al carrito debes iniciar sesi√≥n.</p>
    <button class="boton" (click)="goLogin()">Ir a Login</button>
    <button class="boton cerrar" (click)="showLoginModal = false">Cerrar</button>
  </div>
</div>

<!-- Modal de detalles del ramo -->
<div class="modal-detalles" *ngIf="ramoSeleccionado" (click)="cerrarDetalles()">
  <div class="modal-contenido-detalles" (click)="$event.stopPropagation()">
    <button class="cerrar-modal" (click)="cerrarDetalles()">√ó</button>
    <div class="modal-imagen">
      <img [src]="'http://localhost/MRBouquets/frontend/public/img/' + ramoSeleccionado.img" 
           [alt]="ramoSeleccionado.nombre">
    </div>
    <div class="modal-info">
      <h2>{{ ramoSeleccionado.nombre }}</h2>
      <p class="descripcion">{{ ramoSeleccionado.descripcion }}</p>
      <div class="detalles-adicionales">
        <div class="detalle">
          <span class="etiqueta">Precio:</span>
          <span class="valor precio">{{ ramoSeleccionado.precio | currency:'EUR':'symbol':'1.2-2' }}</span>
        </div>
        <div class="detalle" *ngIf="ramoSeleccionado.categoria">
          <span class="etiqueta">Categor√≠a:</span>
          <span class="valor">{{ ramoSeleccionado.categoria }}</span>
        </div>
        <div class="detalle" *ngIf="ramoSeleccionado.disponibilidad">
          <span class="etiqueta">Disponibilidad:</span>
          <span class="valor disponible">Disponible</span>
        </div>
      </div>
      <button class="boton-agregar" (click)="onAddToCart(ramoSeleccionado)">
        Agregar al carrito
      </button>
    </div>
  </div>
</div>
