<div class="cart-container">
  <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Cabecera ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div class="cart-header">
    <h2>Carrito de Compras</h2>
    <button class="btn-clear" (click)="clearCart()">Vaciar Carrito</button>
    <button class="btn-close" (click)="continueShopping()">√ó</button>
  </div>

  <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Lista de productos ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div class="cart-items">
    <div class="cart-item" *ngFor="let item of items">
      <img
        class="item-img"
        [src]="'http://localhost/MRBouquets/frontend/public/img/' + item.img"
        [alt]="item.nombre"
      />

      <div class="item-details">
        <h3>{{ item.nombre }}</h3>
        <p>{{ item.descripcion }}</p>
        <span class="item-price">
          {{ item.quantity * item.price | currency:'EUR':'symbol':'1.2-2' }}
        </span>
      </div>

      <div class="quantity-controls">
        <button (click)="decrement(item)">‚Äì</button>
        <span>{{ item.quantity }}</span>
        <button (click)="increment(item)">+</button>
      </div>

      <button class="btn-remove" (click)="removeItem(item.id)">üóëÔ∏è</button>
    </div>
  </div>

  <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Resumen ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div class="summary">
    <div class="line">
      <span>Subtotal</span>
      <span>{{ subtotal | currency:'EUR':'symbol':'1.2-2' }}</span>
    </div>
    <div class="line">
      <span>Env√≠o</span>
      <span>Calculado al pagar</span>
    </div>
    <div class="line total">
      <span>Total</span>
      <span>{{ subtotal | currency:'EUR':'symbol':'1.2-2' }}</span>
    </div>
  </div>

  <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Acciones ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <button class="btn-primary full-width" (click)="proceedToCheckout()">
    Proceder al Pago
  </button>
  <button class="btn-secondary full-width" (click)="continueShopping()">
    Seguir Comprando
  </button>

  <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Modal: Selecci√≥n de direcci√≥n ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div class="modal-backdrop" *ngIf="showAddressModal">
    <div class="modal">
      <h3>Selecciona una direcci√≥n de env√≠o</h3>

     <select
      name="direccion"                     
      [(ngModel)]="selectedDireccionId">
      <option *ngFor="let d of direcciones" [ngValue]="d.id"> 
        {{ d.calle }} {{ d.numero }}, {{ d.localidad }}
      </option>
    </select>

      <div class="modal-actions">
        <button class="btn-secondary" (click)="showAddressModal = false">
          Cancelar
        </button>
        <button
          class="btn-primary"
          (click)="confirmarDireccion()"
          [disabled]="!selectedDireccionId"
        >
          Confirmar
        </button>
      </div>
    </div>
  </div>

  <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Modal: Pedido confirmado ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div class="modal-backdrop" *ngIf="showSuccessModal">
    <div class="modal">
      <p>Su pedido est√° confirmado, gracias por su compra.</p>
      <button class="btn-primary" (click)="closeSuccessModal()">Cerrar</button>
    </div>
  </div>
</div>
